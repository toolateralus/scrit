using * from system
using * from raylib
using  math

player = {
  x = 0.0
  y = 0.0
  h = 100
  w = 100
  speed = 0.1
  color = colors.WHITE
  gravity = 0.01
  
  func move() {
    if(isKeyDown(keys.E)) {
      color.r += 1
      color.g += 1
      color.b += 1
      if (color.r > 255) {
        color.r = 0
      }
      if (color.g > 255) {
        color.g = color.a 
      }
      if color.b > 255 {
        color.b = 50
      }
    }
    if isKeyDown(keys.W) {
      y -= speed
    } else {
      y += gravity
    }
    if isKeyDown(keys.S) {
      y += speed
    }
    if isKeyDown(keys.A) {
      x -= speed
    }
    if isKeyDown(keys.D) {
      x += speed
    }
  }
  
  func draw() {
    if (x != undefined && y != undefined) {
      err = drawRectangle(math.floor(x),math.floor(y),h,w, color)
      return err
    } else {
      println("undefined x or y : (x,y) (" + x + "," + y + ")")
    }
  }
  
}

func() {
  initWindow(800, 600, "Raytest")
  for {
    if windowShouldClose() {
      break
    }
    
    player.move()
    
    drawFPS(0,0)
    drawText(24,24,16, tostr({x = player.x, y = player.y}), colors.WHITE)
    
    beginDrawing()
    clearBackground(colors.BLACK)
    
    err = player.draw()
    
    if err != undefined && err != null {
      println("error: " + err)
      break
    }
    
    endDrawing()
    
    sleep(16.6)
    
    println(time())
  }
}()